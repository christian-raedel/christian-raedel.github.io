<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: transports/log-file.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: transports/log-file.js</h1>

    


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var _ = require('lodash')
    , util = require('util')
    , fs = require('fs')
    , Transport = require('../transport').Transport;

/**
 * LogFile - A logging transport implementation using node's StreamWriter
 * to write messages to a logfile.
 * @memberof transports
 * @constructor
 * @param {object} opts (optional) - An object, holding configuration values for the
 * LogFile transport. Valid keys are the 'filename' and the log-message 'format'.
 * @example
 * var clogger = require('node-clogger');
 * var logger = new clogger.CLogger().addTransport(new clogger.transports.LogFile({
        'filename': '{{dirname}}/server.log',
 *      'format': '[{{value:timestamp|datetime}}] - [{{value:id}}] - [{{value:level}}] - {{value:message|capitalize}}',
 *      filters: {
 *          'dirname': function() {
 *              return __dirname;
 *          }
 *      }
 * });
 * logger.debug('%sl%s', 'd', 'c');
 */
function LogFile(opts) {
    Transport.apply(this, ['log-file', opts]);

    this.config.addRequired('filename')
        .setDefault('format', '[{{value:timestamp|datetime}}] [{{value:id|capitalize}}] - {{value:level|uppercase}}:\t{{value:message|capitalize}}\n');

    var self = this;
    this.on('log', function(args) {
        var filename = self.formatString(self.config.getValue('filename'), args);

        var stream = fs.createWriteStream(filename, {encoding: 'utf8', flags: 'a', mode: 0600})
        .on('error', function(err) {
            throw new Error('Configured logfile "' + filename + '" for Transport:LogFile is not writeable!');
        });

        var str = self.formatString(self.config.getValue('format'), args);
        stream.write(str);
        stream.end();
    });
}

util.inherits(LogFile, Transport);

module.exports = LogFile;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="CLogger.html">CLogger</a></li><li><a href="transports.Console.html">Console</a></li><li><a href="transports.CustomFunction.html">CustomFunction</a></li><li><a href="transports.LogFile.html">LogFile</a></li><li><a href="transports.TaffyDb.html">TaffyDb</a></li><li><a href="transports.Transport.html">Transport</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha9</a> on Fri Aug 22 2014 14:25:38 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
