<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: Wampify</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: Wampify</h1>

    



<section>

<header>
    <h2>
    Wampify
    </h2>
    
</header>

<article>
    <div class="container-overview">
    

    
        
<dt>
    <h4 class="name" id="Wampify"><span class="type-signature"></span>new Wampify<span class="signature">(opts)</span><span class="type-signature"> &rarr; {object}</span></h4>

    
</dt>
<dd>

    
    <div class="description">
        Create a new instance of <a href="Wampify.html">Wampify</a> WebSocket-Server. Valid options
are: a 'name', a 'port' number or a (http-) 'server' instance, an optional instance of
<a href="http://github.com/christian-raedel/node-clogger">CLogger</a> and all [websocket-server
options]<a href="https://github.com/einaros/ws/blob/master/doc/ws.md">https://github.com/einaros/ws/blob/master/doc/ws.md</a>. If provided, the
option 'plugins' points to a directory from which RPC-function are loaded from.
    </div>
    

    

    

    
        <h5>Parameters:</h5>
        

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>opts</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            

            

            <td class="description last">(optional) - See example for valid configuration options.</td>
        </tr>

    
    </tbody>
</table>
    

    
<dl class="details">
    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="wampify.js.html">wampify.js</a>, <a href="wampify.js.html#line34">line 34</a>
    </li></ul></dd>
    

    

    

    
</dl>


    

    

    

    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    this - An instance of <a href="Wampify.html">Wampify</a>.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">object</span>


    </dd>
</dl>

        

    
        <h5>Example</h5>
        
    <pre class="prettyprint"><code>var Wampify = require('wampify');
var server = new Wampify({
     name: 'wampify',
     port: 3000,                             // port or server is mandatory!
     server: require('http').createServer(), //
     logger: clogger,
     plugins: __dirname + '/rpc-function-modules'
});</code></pre>

    
</dd>

    
    </div>

    

    

    

    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        <dl>
            
<dt>
    <h4 class="name" id="addChannel"><span class="type-signature">(static) </span>addChannel<span class="signature">(uri, opts)</span><span class="type-signature"> &rarr; {object}</span></h4>

    
</dt>
<dd>

    
    <div class="description">
        Create a new channel for publish/subscribe. A valid option
is 'ack' (boolean). If set, every published message is acknowledged by the server.
    </div>
    

    

    

    
        <h5>Parameters:</h5>
        

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>uri</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The identifying path to the channel.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>opts</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            

            

            <td class="description last">(optional) - Options to configure the channel.</td>
        </tr>

    
    </tbody>
</table>
    

    
<dl class="details">
    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="wampify.js.html">wampify.js</a>, <a href="wampify.js.html#line396">line 396</a>
    </li></ul></dd>
    

    

    

    
</dl>


    

    

    

    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    this - An instance of <a href="Wampify.html">Wampify</a>.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">object</span>


    </dd>
</dl>

        

    
</dd>

        
            
<dt>
    <h4 class="name" id="loadPlugins"><span class="type-signature">(static) </span>loadPlugins<span class="signature">(dir)</span><span class="type-signature"> &rarr; {object}</span></h4>

    
</dt>
<dd>

    
    <div class="description">
        Load each Javascript-file from a directory as node-module and register
its methods as remote procedures.
    </div>
    

    

    

    
        <h5>Parameters:</h5>
        

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>dir</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">(optional) - A directory with RPC-function-modules to be loaded.</td>
        </tr>

    
    </tbody>
</table>
    

    
<dl class="details">
    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="wampify.js.html">wampify.js</a>, <a href="wampify.js.html#line296">line 296</a>
    </li></ul></dd>
    

    

    

    
</dl>


    

    

    

    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    this - An instance of <a href="Wampify.html">Wampify</a>.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">object</span>


    </dd>
</dl>

        

    
</dd>

        
            
<dt>
    <h4 class="name" id="registerRPC"><span class="type-signature">(static) </span>registerRPC<span class="signature">(uri, fn)</span><span class="type-signature"></span></h4>

    
</dt>
<dd>

    
    <div class="description">
        Register a function to be callable remotely. The function can have variable
arguments length, which are sent with the WebSocket-message. The first four message-fields
are reserved by 'type', 'uri', 'id' and 'opts' (see example).
    </div>
    

    

    

    
        <h5>Parameters:</h5>
        

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>uri</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The identifying path to the function.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>fn</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last">The function itself.</td>
        </tr>

    
    </tbody>
</table>
    

    
<dl class="details">
    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="wampify.js.html">wampify.js</a>, <a href="wampify.js.html#line327">line 327</a>
    </li></ul></dd>
    

    

    

    
</dl>


    

    

    

    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    [object} this - An instance of <a href="Wampify.html">Wampify</a>.
</div>



        

    
        <h5>Example</h5>
        
    <pre class="prettyprint"><code>// on server-side
var _ = require('lodash');
var Wampify = require('wampify');
var server = new Wampify({port: 3000}).registerRPC('com.domain.my-functions.sum', function () {
     var args = _.toArray(arguments);
     var sum = _.reduce(args, function (a, b) {
         return a + b;
     });
     return [sum];
 });

// on client-side
var WebSocket = require('ws');
var ws = new WebSocket('ws://localhost:3000');
ws.on('open', function () {
     ws.send(JSON.stringify(['RPC', 'com.domain.my-functions.sum', 123, {}, 1, 2, 3, 4, 5, 6, 7]));
});
ws.on('message', function (data) {
     var message = JSON.parse(data);
     console.log('sum = %d', message[4]);  // 28
});</code></pre>

    
</dd>

        
            
<dt>
    <h4 class="name" id="removeChannel"><span class="type-signature">(static) </span>removeChannel<span class="signature">(uri)</span><span class="type-signature"> &rarr; {object}</span></h4>

    
</dt>
<dd>

    
    <div class="description">
        Delete a channel from the server.
    </div>
    

    

    

    
        <h5>Parameters:</h5>
        

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>uri</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The identifying path to the channel.</td>
        </tr>

    
    </tbody>
</table>
    

    
<dl class="details">
    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="wampify.js.html">wampify.js</a>, <a href="wampify.js.html#line423">line 423</a>
    </li></ul></dd>
    

    

    

    
</dl>


    

    

    

    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    this - An instance of <a href="Wampify.html">Wampify</a>.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">object</span>


    </dd>
</dl>

        

    
</dd>

        
            
<dt>
    <h4 class="name" id="unregisterRPC"><span class="type-signature">(static) </span>unregisterRPC<span class="signature">(uri)</span><span class="type-signature"> &rarr; {object}</span></h4>

    
</dt>
<dd>

    
    <div class="description">
        Delete a registered function by its uri.
    </div>
    

    

    

    
        <h5>Parameters:</h5>
        

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>uri</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The identifying path to the function.</td>
        </tr>

    
    </tbody>
</table>
    

    
<dl class="details">
    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="wampify.js.html">wampify.js</a>, <a href="wampify.js.html#line374">line 374</a>
    </li></ul></dd>
    

    

    

    
</dl>


    

    

    

    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    this - An instance of <a href="Wampify.html">Wampify</a>.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">object</span>


    </dd>
</dl>

        

    
</dd>

        
            
<dt>
    <h4 class="name" id="use"><span class="type-signature">(static) </span>use<span class="signature">(fn)</span><span class="type-signature"> &rarr; {object}</span></h4>

    
</dt>
<dd>

    
    <div class="description">
        Register a function as middleware. This function
will be called with parameters 'socket' and 'message' and must
return the edited 'message'. This can be useful i.e. for
authorization or custom acknowledge methods.
    </div>
    

    

    

    
        <h5>Parameters:</h5>
        

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>fn</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last">A function to use as middleware.</td>
        </tr>

    
    </tbody>
</table>
    

    
<dl class="details">
    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="wampify.js.html">wampify.js</a>, <a href="wampify.js.html#line552">line 552</a>
    </li></ul></dd>
    

    

    

    
</dl>


    

    

    

    

    

    
    <h5>Returns:</h5>
    
            
<div class="param-desc">
    this - An instance of <a href="Wampify.html">Wampify</a>.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">object</span>


    </dd>
</dl>

        

    
        <h5>Example</h5>
        
    <pre class="prettyprint"><code>var Wampify = require('wampify');

var server = Wampify({port: 3000}).use(function (socket, message) {
     socket.send(JSON.stringify(['Custom message']);
     console.log('received message [%j] from socket [%s]...', message, socket.id);
     return message;
});</code></pre>

    
</dd>

        </dl>
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="Wampify.html">Wampify</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha9</a> on Sun Aug 31 2014 13:50:23 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>